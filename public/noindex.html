<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In</title>
</head>
<body>
    <form id="form">
        <p>Sign into Hitzii</p>
        <input type="text" name="email" id="email" />
        <input type="password" name="password" id="password" />
        <input type="submit" value="SignIn">
    </form>

    <script>
        window.addEventListener("load", () => {
            const form = document.getElementById('form')

            async function sendData() {
                const formdata = new FormData(form)

                const email = document.getElementById('email').value
                const password = document.getElementById('password').value

                const url = 'http://localhost:3031/api/v1'
                + '/auth/signin?'
                + 'response_type=code'
                + '&client_id=1234ABCD'
                + '&redirect_uri=http://192.168.1.38:3000/callback'
                + '&state=12345678'
                + '&nonce=asdflkjh'

                const requestConfig = {
                    method: 'POST',
                    mode: 'cors',
                    headers: {
                        'WWW-Authenticate': 'Basic realm="hitzii-client"',
                        'Authorization': 'Basic MTIzNEFCQ0Q6NyNZX2Y0VDhlUi5EcjNAbk41Pw==',
                        // "Content-Type": "multipart/form-data;; charset=utf-8; boundary=123456789"
                    },
                    redirect: 'follow',
                    body: formdata

                }

                try {
                    const response = await fetch(url, requestConfig)
                    console.log('Our response is %o', response)
                    window.location.href = response.url
                } catch (error) {
                    console.error(error)
                }
            }

            form.addEventListener('submit', (event) => {
                event.preventDefault()
                sendData()
            })
        })
    </script>
</body>
</html>